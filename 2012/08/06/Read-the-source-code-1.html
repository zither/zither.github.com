
<!doctype html>
<html lang="zh-CN">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <title>Laravel源码笔记 | 槐花九九</title>
  <meta name="author" content="MiniMee" />
  <link href="/atom.xml" rel="alternate" title="Tom Preston-Werner" type="application/atom+xml" />
  <link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen, projection" />
  <link rel="stylesheet" type="text/css" href="/css/highlight/99_solarized_dark.css" />
  <script src="/js/highlight.pack.js"></script>
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-33950131-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
</head>
<body>
  <div class="site">
    <div class="title">
        <a href="/">槐花九九</a>
        <a class="extra" href="/archive.html">存档</a>
    </div>
    
    
    <div id="post">
    <h1>Laravel源码笔记</h1>
    <p class="meta">06 Aug 2012 - By MiniMee</p>

<p>无聊的时候看下Laravel的源码，前面写过一篇打印hello，world的文章，现在来看看到底是怎么完成的，随便可以熟悉下laravel框架的运行。</p>

<p>在框架的入口文件中主要进行了两个操作：
    require '../paths.php';
    require path('sys').'laravel.php';
那就从这里入手看看有什么好玩的东西。打开paths.php文件，里面最重要的是定义了一个path函数：
    function path($path)
    {
        return $GLOBALS['laravel_paths'][$path];
    }
这个函数主要是取得laravel框架的目录路径，在其他文件里会多次用到。另外在paths文件里定义了框架的app、sys、public等路径。入口文件中加载的另一个文件：laravel.php则是框架的主要文件。
    require  'core.php';
在laravel文件中首先载入的是框架的核心文件，如果有印象的话，在Artisan命令行工具中同样是加载了它，也就是说，如果我们理解了core文件，那么就知道了laravel框架的运行路线。我们在这里设个断点，先去看看core文件。</p>

<p>在core文件中先是定义了命名空间Laravel和一系列常量，我们可以留意一下下面这句：
    define('DEFAULT_BUNDLE','application');
定义常量之后，用在paths文件中定义的path函数加载了六个系统文件：
    require path('sys').'ioc'.EXT;
    require path('sys').'event'.EXT;
    require path('sys').'bundle'.EXT;
    require path('sys').'config'.EXT;
    require path('sys').'helper'.EXT;
    require path('sys').'autoloader'.EXT;
暂时可以猜测这六个文件是框架依赖比较大的，然后我们要留意之后注册的一个自动加载函数:
    spl_autoload_register(array('Laravel&#92;Autolaoder','load'));
这个load函数应该是定义在上面加载的autoloader文件之中。</p>
    </div>

    <div id="related">
            <div id="disqus_thread"></div>
            <script type="text/javascript">
                /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                var disqus_shortname = 'minimee'; // required: replace example with your forum shortname

                /* * * DON'T EDIT BELOW THIS LINE * * */
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
            

    </div>

    
    <div class="footer"></div>
  </div>
  <a href="http://github.com/zither"><img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" /></a>
  <script>hljs.initHighlightingOnLoad();</script>
</body>
</html>
